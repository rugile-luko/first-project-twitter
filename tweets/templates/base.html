{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Tweets{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/accounts.css' %}">
    <link href="{% static 'fontawesome/css/fontawesome.css' %}" rel="stylesheet">
    <link href="{% static 'fontawesome/css/brands.css' %}" rel="stylesheet">
    <link href="{% static 'fontawesome/css/solid.css' %}" rel="stylesheet">
    {% block stylesheet %}{% endblock %}
</head>
<body>
{% block body %}
    <nav class="navbar navbar-expand-sm navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="{% url 'home' %}">All tweets</a>
            {% if user.is_authenticated %}
                <div class="btn-toolbar ml-auto">
                    <a href="{% url 'contact' %}" class="btn btn-success" role="button">Contact Us</a>
                    <a href="{% url 'profile' request.user %}" class="btn btn-secondary ml-2" role="button">My
                        Profile </a>
                    <a href="{% url 'logout' %}" class="btn btn-danger ml-2" role="button">Log out</a>
                </div>
            {% else %}
                <div class="btn-toolbar ml-auto">
                    <a href="{% url 'contact' %}" class="btn btn-success">Contact Us</a>
                    <a href="{% url 'login' %}" class="btn btn-outline-secondary ml-2">Log in</a>
                    <a href="{% url 'signup' %}" class="btn btn-primary ml-2">Sign up</a>
                </div>
            {% endif %}
        </div>
    </nav>
    <div class="container">
        {#        <div class="breadcrumb my-4">#}
        <div class="navigation-container">
            {% block breadcrumb %}
            {% endblock %}
        </div>

        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
        {% endfor %}
        {% block content %}
        {% endblock %}
    </div>
{% endblock %}
<script src="{% static 'js/jquery-3.4.1.min.js' %}"></script>
<script src="{% static 'js/js.cookie.min.js' %}"></script>

<script type="text/javascript">
    function makeFavorite(e, tweet_id) {
        e.preventDefault();
        const xhr = new XMLHttpRequest();
        xhr.open('POST', '/ajax/tweet/'+ tweet_id + '/favorite/', true);
        xhr.onload = function () {
            if(this.status === 200) {
                const favorite = document.getElementById('tweetHeart' + tweet_id);
                if(favorite.className === 'fas fa-heart fa-2x') {
                favorite.className = 'fas fa-heart fa-cog fa-2x';
                } else {
                favorite.className = 'fas fa-heart fa-2x';
                }
            }
        };
        xhr.send('favorite');
    }

    function likeComment(e, comment_id) {
        e.preventDefault();
        const xhr = new XMLHttpRequest();
        xhr.open('POST', '/ajax/comment/' + comment_id + '/like/', true);
        xhr.onload = function () {
            if(this.status === 200) {
                let like = document.getElementById('commentLike' + comment_id);
                const currentText = like.innerText;
                let output;

                if(currentText === 'Like') {
                    output = 'Unlike';
                } else {
                    output = 'Like';
                }

                like.innerHTML = output;
            }
        };
        xhr.send('like');
    }

    const tweet_form = document.getElementById('form-field');
    let total_number = document.getElementById('message_symbols_count').innerText;
    tweet_form.addEventListener('keyup', (e) => {
        console.log('yo');
        const userText = e.target.value;
        let number = userText.length;
        let count = 140 - number;
        document.getElementById('message_symbols_count').innerHTML = `${count}`;
        e.preventDefault();
    });

    // without jQuery (doesn't work in older IEs)
    // document.addEventListener('DOMContentLoaded', function () {
        // your code goes here
       // tweet_form.dispatchEvent(new Event('keyup'));
       // console.log('loaded');
    // }, false);

</script>
</body>
</html>